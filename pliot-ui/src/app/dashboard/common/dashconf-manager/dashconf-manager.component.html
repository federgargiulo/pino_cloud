<form [formGroup]="signalForm">
  <h4 class="mt-4 mb-3">Signal Management</h4>

  <div formArrayName="signals" class="d-flex flex-column gap-4">
    <div *ngFor="let signal of signals.controls; let i = index" [formGroupName]="i" class="signal-row">

      <mat-form-field appearance="fill" class="signal-field">
        <mat-label>Signal ID *</mat-label>
        <input matInput type="text" formControlName="signalId" required>
        <mat-error *ngIf="signal.get('signalId')?.invalid && signal.get('signalId')?.touched">
          Signal ID is required
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill" class="signal-field">
        <mat-label>Type *</mat-label>
        <mat-select formControlName="chartType" required>
          <mat-option value="bar">Bar Chart</mat-option>
          <mat-option value="bubble">Bubble</mat-option>
          <mat-option value="doughnut">Doughnut</mat-option>
          <mat-option value="line">Line</mat-option>
        </mat-select>
        <mat-error *ngIf="signal.get('chartType')?.invalid && signal.get('chartType')?.touched">
          Type is required
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill" class="signal-field">
        <mat-label>Label</mat-label>
        <input matInput type="text" formControlName="label">
      </mat-form-field>

      <button mat-icon-button color="warn" (click)="removeSignal(i)" aria-label="Remove signal">
        <mat-icon>delete</mat-icon>
      </button>
    </div>
  </div>

  <div class="d-flex flex-wrap gap-2 justify-content-end mt-4">
    <button mat-button type="button" (click)="addSignal()">
      <mat-icon>add</mat-icon> Add Signal
    </button>

    <button mat-button type="button" (click)="submit()">
      <mat-icon>code</mat-icon> Show JSON
    </button>

    <button mat-flat-button color="primary" type="button" (click)="conferma()">
      Confirm Signals
    </button>
  </div>
</form>
